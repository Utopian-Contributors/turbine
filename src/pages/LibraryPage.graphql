query library($name: String!) {
  library(name: $name) {
    id
    name
    description
    homepage
    repository
    integrated
    isStarred
    lastVersion {
      version
      size
      publishedAt
    }
    versions {
      version
      publishedAt
    }
    subpaths {
      id
      path
      since {
        id
        version
      }
    }
    sameVersionRequirement {
      id
      dependingOn {
        id
        name
      }
    }
  }
}

mutation editSameVersionRequirement($library: String!, $dependingOn: String!) {
  editSameVersionRequirement(library: $library, dependingOn: $dependingOn)
}

mutation addSubpath($library: String!, $path: String!, $since: String) {
  addSubpath(library: $library, path: $path, since: $since)
}

mutation editSubpath($subpath: String!, $path: String!, $since: String) {
  editSubpath(subpath: $subpath, path: $path, since: $since)
}

mutation deleteSubpath($subpath: String!) {
  deleteSubpath(subpath: $subpath)
}

query libraryUsage($name: String!) {
  libraryUsage(name: $name) {
    downloads
    bandwidth {
      total
      rank
    }
    prev {
      downloads
      bandwidth {
        total
        rank
      }
    }
  }
}

query versionUsage($library: String!) {
  versionUsage(library: $library) {
    integrated
    version
    downloads
  }
}

query versionIntegrations($library: String!) {
  versionIntegrations(library: $library) {
    ...VersionConfig
  }
}

mutation toggleIntegrateVersion($version: String!) {
  toggleIntegrateVersion(id: $version) {
    id
  }
}

fragment VersionConfig on VersionIntegrations {
  integrated {
    id
    version
    size
  }
  popular {
    id
    version
    size
  }
  other {
    id
    version
    size
  }
}

query versionFiles($library: String!) {
  versionFileIntegrations(library: $library) {
    ...VersionFileConfig
  }
}

mutation toggleIntegrateVersionFile($versionFile: String!) {
  toggleIntegrateVersionFile(id: $versionFile) {
    id
  }
}

fragment VersionFileConfig on VersionFileIntegrations {
  integrated {
    file {
      ...VersionFile
    }
    bandwidth
  }
  popular {
    file {
      ...VersionFile
    }
    bandwidth
  }
}

fragment VersionFile on VersionFile {
  id
  path
  integrated
  version {
    id
    version
  }
}
